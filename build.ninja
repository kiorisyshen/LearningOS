# build.ninja
CODE_ROOT = .
BUILD_ROOT = build

cc     = cross_compiler/i386elfgcc/bin/i386-elf-g++
cflags = -ffreestanding

linker = cross_compiler/i386elfgcc/bin/i386-elf-ld
linkAsmEntry_flags = -Ttext 0x1000 --oformat binary

rule compile
  command = $cc $cflags -c $in -o $out

rule linkAsmEntry
  command = $linker -o $out $linkAsmEntry_flags $in

build $BUILD_ROOT/kernel.o: compile $CODE_ROOT/kernel.cpp
build $BUILD_ROOT/kernel.bin: linkAsmEntry $BUILD_ROOT/kernel_entry.o $BUILD_ROOT/kernel.o

default $BUILD_ROOT/kernel.bin
